package postgres

import "regexp"

var (
	rePartition        = regexp.MustCompile(`(?is)PARTITION\s+BY\s+.*`)
	rePartitionComment = regexp.MustCompile(`(?is)/\*!50100\s+PARTITION\s+BY\s+.*?\*/`)
	rePartitionSimple  = regexp.MustCompile(`(?is)PARTITION\s+BY\s+KEY\s*\(.*?\)\s*\(.*?\)\s*\)`)
	rePartitionComplex = regexp.MustCompile(`(?is)PARTITION\s+BY\s+.*?\)\s*\)\s*`)
)

// 基本类型正则缓存

// postgresReservedKeywords 定义PostgreSQL的保留关键字
var postgresReservedKeywords = map[string]bool{
	// 常用数据类型相关
	"type":        true,
	"class":       true,
	"select":      true,
	"insert":      true,
	"update":      true,
	"delete":      true,
	"from":        true,
	"where":       true,
	"and":         true,
	"or":          true,
	"not":         true,
	"in":          true,
	"is":          true,
	"null":        true,
	"default":     true,
	"primary":     true,
	"key":         true,
	"unique":      true,
	"foreign":     true,
	"references":  true,
	"check":       true,
	"constraint":  true,
	"table":       true,
	"column":      true,
	"view":        true,
	"index":       true,
	"sequence":    true,
	"function":    true,
	"procedure":   true,
	"trigger":     true,
	"schema":      true,
	"database":    true,
	"user":        true,
	"group":       true,
	"role":        true,
	"grant":       true,
	"revoke":      true,
	"create":      true,
	"alter":       true,
	"drop":        true,
	"truncate":    true,
	"begin":       true,
	"commit":      true,
	"rollback":    true,
	"savepoint":   true,
	"transaction": true,
	"lock":        true,
	"unlock":      true,
	// PostgreSQL官方文档中的保留关键字
	"absolute":          true,
	"action":            true,
	"admin":             true,
	"aggregate":         true,
	"all":               true,
	"allocate":          true,
	"always":            true,
	"analyse":           true,
	"any":               true,
	"array":             true,
	"as":                true,
	"asc":               true,
	"asymmetric":        true,
	"at":                true,
	"atomic":            true,
	"authorize":         true,
	"backward":          true,
	"before":            true,
	"between":           true,
	"bigint":            true,
	"binary":            true,
	"bit":               true,
	"bitvar":            true,
	"boolean":           true,
	"both":              true,
	"by":                true,
	"call":              true,
	"cascade":           true,
	"case":              true,
	"cast":              true,
	"catalog":           true,
	"char":              true,
	"character":         true,
	"charvar":           true,
	"close":             true,
	"clustered":         true,
	"coalesce":          true,
	"collate":           true,
	"collation":         true,
	"compress":          true,
	"condition":         true,
	"configure":         true,
	"connection":        true,
	"content":           true,
	"continue":          true,
	"convert":           true,
	"copy":              true,
	"corresponding":     true,
	"cross":             true,
	"cube":              true,
	"current":           true,
	"current_catalog":   true,
	"current_date":      true,
	"current_role":      true,
	"current_schema":    true,
	"current_time":      true,
	"current_timestamp": true,
	"current_user":      true,
	"cursor":            true,
	"cycle":             true,
	"data":              true,
	"date":              true,
	"day":               true,
	"deallocate":        true,
	"dec":               true,
	"decimal":           true,
	"declare":           true,
	"deferrable":        true,
	"deferred":          true,
	"delimiter":         true,
	"desc":              true,
	"destination":       true,
	"deterministic":     true,
	"diagnostics":       true,
	"disable":           true,
	"discard":           true,
	"distinct":          true,
	"do":                true,
	"document":          true,
	"domain":            true,
	"double":            true,
	"dynamic":           true,
	"each":              true,
	"else":              true,
	"enable":            true,
	"encoding":          true,
	"encrypted":         true,
	"end":               true,
	"every":             true,
	"except":            true,
	"exchange":          true,
	"exclude":           true,
	"execute":           true,
	"exists":            true,
	"external":          true,
	"extract":           true,
	"false":             true,
	"fetch":             true,
	"file":              true,
	"filter":            true,
	"first":             true,
	"float":             true,
	"for":               true,
	"force":             true,
	"forward":           true,
	"free":              true,
	"full":              true,
	"generated":         true,
	"get":               true,
	"global":            true,
	"grouping":          true,
	"handler":           true,
	"having":            true,
	"hold":              true,
	"hour":              true,
	"identity":          true,
	"if":                true,
	"ignore":            true,
	"ilike":             true,
	"immediate":         true,
	"including":         true,
	"increment":         true,
	"initially":         true,
	"inline":            true,
	"inner":             true,
	"inout":             true,
	"input":             true,
	"insensitive":       true,
	"int":               true,
	"integer":           true,
	"intersect":         true,
	"interval":          true,
	"into":              true,
	"isolation":         true,
	"join":              true,
	"language":          true,
	"large":             true,
	"last":              true,
	"lateral":           true,
	"leading":           true,
	"left":              true,
	"level":             true,
	"limit":             true,
	"listen":            true,
	"load":              true,
	"local":             true,
	"localtime":         true,
	"localtimestamp":    true,
	"location":          true,
	"long":              true,
	"loop":              true,
	"match":             true,
	"maxvalue":          true,
	"merge":             true,
	"method":            true,
	"minvalue":          true,
	"minute":            true,
	"mod":               true,
	"mode":              true,
	"month":             true,
	"move":              true,
	"name":              true,
	"national":          true,
	"nchar":             true,
	"next":              true,
	"no":                true,
	"none":              true,
	"notify":            true,
	"nowait":            true,
	"nullif":            true,
	"numeric":           true,
	"object":            true,
	"of":                true,
	"off":               true,
	"offset":            true,
	"oids":              true,
	"on":                true,
	"only":              true,
	"open":              true,
	"operator":          true,
	"option":            true,
	"order":             true,
	"ordinality":        true,
	"out":               true,
	"output":            true,
	"over":              true,
	"overlaps":          true,
	"overlay":           true,
	"owner":             true,
	"partial":           true,
	"partition":         true,
	"password":          true,
	"placing":           true,
	"position":          true,
	"postfix":           true,
	"prefix":            true,
	"prior":             true,
	"privileges":        true,
	"program":           true,
	"public":            true,
	"quote":             true,
	"range":             true,
	"read":              true,
	"real":              true,
	"refresh":           true,
	"release":           true,
	"rename":            true,
	"repeat":            true,
	"replace":           true,
	"restart":           true,
	"restore":           true,
	"restrict":          true,
	"return":            true,
	"returns":           true,
	"right":             true,
	"rollup":            true,
	"row":               true,
	"rows":              true,
	"rule":              true,
	"scroll":            true,
	"search":            true,
	"second":            true,
	"section":           true,
	"security":          true,
	"serial":            true,
	"server":            true,
	"session":           true,
	"session_user":      true,
	"setsession":        true,
	"setof":             true,
	"share":             true,
	"similar":           true,
	"simple":            true,
	"skip":              true,
	"smallint":          true,
	"snapshot":          true,
	"some":              true,
	"space":             true,
	"start":             true,
	"statement":         true,
	"static":            true,
	"statistics":        true,
	"stdin":             true,
	"stdout":            true,
	"storage":           true,
	"string":            true,
	"struct":            true,
	"style":             true,
	"substring":         true,
	"sum":               true,
	"symmetric":         true,
	"system":            true,
	"system_user":       true,
	"tablespace":        true,
	"temp":              true,
	"temporary":         true,
	"then":              true,
	"time":              true,
	"timestamp":         true,
	"timezone":          true,
	"to":                true,
	"trailing":          true,
	"translate":         true,
	"translation":       true,
	"treat":             true,
	"trim":              true,
	"true":              true,
	"trusted":           true,
	"unbounded":         true,
	"uncompressed":      true,
	"unencrypted":       true,
	"union":             true,
	"unknown":           true,
	"unlisten":          true,
	"using":             true,
	"values":            true,
	"varchar":           true,
	"varchar2":          true,
	"varying":           true,
	"virtual":           true,
	"volatile":          true,
	"wait":              true,
	"when":              true,
	"whenever":          true,
	"while":             true,
	"with":              true,
	"without":           true,
	"work":              true,
	"write":             true,
	"year":              true,
	"zone":              true,
}

// IsPostgresReservedKeyword 检查一个字符串是否是PostgreSQL保留关键字
func IsPostgresReservedKeyword(keyword string) bool {
	_, exists := postgresReservedKeywords[keyword]
	return exists
}
